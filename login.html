<!DOCTYPE html>
<!-- saved from url=(0049)https://getbootstrap.com/docs/4.3/examples/album/ -->
<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <title>eMercado - Todo lo que busques está aquí</title>

  <link rel="canonical" href="https://getbootstrap.com/docs/4.3/examples/album/">
  <link href="https://fonts.googleapis.com/css?family=Raleway:300,300i,400,400i,700,700i,900,900i" rel="stylesheet">
  <!-- Bootstrap core CSS -->
  <link href="css/bootstrap.min.css" rel="stylesheet">
  <link href="css/styles.css" rel="stylesheet">
  <style>
    html, body{
      height: 100%;
    }

    body {
      display: -ms-flexbox;
      display: flex;
      -ms-flex-align: center;
      align-items: center;
      padding-top: 40px;
      padding-bottom: 40px;
      background-color: #f5f5f5;
    }

    .signin {
      width: 100%;
      max-width: 330px;
      padding: 15px;
      margin: auto;
    }
  </style>

  <script>
  function callme(){
      var name = document.getElementById('inputEmail').value;
      sessionStorage.setItem('userName', name);
      var arrNombre = sessionStorage.getItem('userName').split("@");
      var soloNombre = arrNombre[0];
      sessionStorage.setItem('soloNombreUsuario',soloNombre);

      var bandera = false;
      // si la variable en el localStorage existe, se entra en este if
      if (localStorage.getItem("PerfilUsuario") != null){
        arregloUsuarios = JSON.parse(localStorage.getItem("PerfilUsuario"));

        //con este for, recorremos los usuarios que están guardados, buscando si el email ya esta registrado
        for (var i in arregloUsuarios){
          if (arregloUsuarios[i].email == name){
            bandera = true;
            break;
          }
        }
      }
      // si el usuario no está previamente registrado entra al if
      if (!bandera){
        //si la variable arregloUsuarios existe, se entra en el if
        if (typeof arregloUsuarios != 'undefined'){
          arregloUsuarios.push(
            {
              primerNombre: "",
              segundoNombre: "",
              primerApellido: "",
              segundoApellido: "",
              email: name,
              numeroContacto: ""
            }
          );
          localStorage.setItem("PerfilUsuario", JSON.stringify(arregloUsuarios));
        } else { //si la variable arregloUsuarios no existe, se entra en el else y se crea
          var arregloUsuarios = [];
          arregloUsuarios.push(
            {
              primerNombre: "",
              segundoNombre: "",
              primerApellido: "",
              segundoApellido: "",
              email: name,
              numeroContacto: ""
            }
          );
          localStorage.setItem("PerfilUsuario", JSON.stringify(arregloUsuarios));
        }
      }
  }
</script>

</head>

<body class="text-center">
  <div class="container p-5">
    <img class="mb-4" src="img/login.png" width="50%" >
    <form onsubmit="callme()" class="form-signin" style="width: 25%; margin-left: 38%;" action="index.html">
      <h1 class="h3 mb-3 font-weight-normal">Inicie Sesión</h1>
      <label for="inputEmail" class="sr-only">Email</label>
      <input type="email" id="inputEmail" class="form-control" placeholder="Email address" style="margin: 10px;" required autofocus>
      <label for="inputPassword" class="sr-only">Password</label>
      <input type="password" id="inputPassword" class="form-control" placeholder="Password" style="margin: 10px;" required>
      <div class="checkbox mb-3">
        <label>
          <input type="checkbox" value="remember-me"> Remember me
        </label>
      </div>
      <button class="btn btn-lg btn-primary btn-block" type="submit" style="margin: 10px;">Sign in</button>
      <p class="mt-5 mb-3 text-muted">&copy; 2017-2019</p>
    </form>
  </div>

  <script src="js/init.js"></script>
  <script src="js/login.js"></script>
</body>
</html>
